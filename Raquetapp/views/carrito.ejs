<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>
    OPENsourceTENNIS
  </title>
  <link rel='stylesheet' href='/css/style.css' />
  <link rel='stylesheet' href='/css/partials/1header.css' />
  <link rel='stylesheet' href='/css/partials/2footer.css' />
  <link rel="stylesheet" href="/css/carrito.css">

</head>

<body>
  <%- include('./partials/1header.ejs') %>
  <main>
    <h1>üõí Tu carrito</h1>

    <div id="carrito" class="carrito">
      
      <% productos.forEach((producto)=> { %>
        <div class="item">
          <img src="<%= producto.imagen %>" alt="<%= producto.nombre %>">
          <p>
            <%= producto.nombre %>
          </p>
          <span>$<%= producto.precio %></span>
          <button class="btn_agregar" data-id="<%= producto.id %>">Quitar del Carrito</button>
        </div>
        <% }) %>
    </div>
    <form class="formPagar" action="/carrito/pagar" method="post">
  <input type="hidden" name="nombreUsuario" id="inputUsuario">
  <input type="hidden" name="productosParaPagar" id="inputProductos">
  <button class="btnPagar" type="submit">PAGAR</button>
</form>

<script>
  // Asumiendo que tu variable "productos" viene del backend
 
  const productos = JSON.stringify(productos);

  const inputUsuario = document.getElementById("inputUsuario");
  const inputProductos = document.getElementById("inputProductos");

  // Aqu√≠ puedes asignar el nombre del usuario, por ejemplo:
  inputUsuario.value = "<%= usuario.nombre %>"; // O tomarlo de tu sesi√≥n si lo tienes

  // Llenamos los IDs de los productos
  const ids = productos.map(p => p.id);
  inputProductos.value = ids.join(",");

  // Opcional: si quieres que el bot√≥n PAGAR haga algo m√°s antes de enviar, puedes manejar el submit aqu√≠
  const form = document.querySelector(".formPagar");
  form.addEventListener("submit", function(e) {
    if (!inputUsuario.value || ids.length === 0) {
      e.preventDefault();
      alert("No hay productos o usuario definido");
    }
  });
</script>

  </main>
  <%- include('./partials/2footer.ejs') %>
  <script src="/js/carrito.js"></script>
</body>

</html>